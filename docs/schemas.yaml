# schemas.yaml
# BigQuery table schemas for the Bitcoin SOPR project
# Claude: Use these exact schemas when creating tables

tables:
  daily_prices:
    description: Historical BTC-USD daily prices from yfinance
    dataset: bitcoin_analytics
    schema:
      - name: date
        type: DATE
        mode: REQUIRED
        description: Trading date
      - name: price_usd
        type: FLOAT64
        mode: REQUIRED
        description: Daily closing price in USD
    partitioned: false
    clustered: false

  utxo_index:
    description: Index of Bitcoin UTXO creations for SOPR joins
    dataset: bitcoin_analytics
    schema:
      - name: tx_hash
        type: STRING
        mode: REQUIRED
        description: Transaction hash where output was created
      - name: output_index
        type: INT64
        mode: REQUIRED
        description: Index of the output within the transaction
      - name: block_date
        type: DATE
        mode: REQUIRED
        description: Date the output was created
      - name: created_at
        type: TIMESTAMP
        mode: REQUIRED
        description: Exact timestamp of creation
      - name: btc_amount
        type: FLOAT64
        mode: REQUIRED
        description: BTC value of the output
    partitioned: true
    partition_field: block_date
    clustered: true
    cluster_fields: [tx_hash]
